# Linux KVM launcher
# This only makes sense if you also define CONFIG_LINUX_KVM.
# You probably also want CONFIG_LINUX_VIRTIO
modules-$(CONFIG_KVMTOOL) += kvmtool

ifneq "$(CONFIG_LINUX_VIRTIO)" "y"
$(warn "$(BOARD): kvmtool included without CONFIG_LINUX_VIRTIO")
endif
ifneq "$(CONFIG_LINUX_KVM)" "y"
$(error "$(BOARD): kvmtool included without CONFIG_LINUX_KVM")
endif

kvmtool_depends := mbedtls $(musl_dep)

#kvmtool_version := git
#kvmtool_repo := https://github.com/osresearch/kvmtool

kvmtool_version := 207fb98
kvmtool_dir := kvmtool-$(kvmtool_version)
kvmtool_tar := kvmtool-$(kvmtool_version).tar.gz
kvmtool_url := https://git.kernel.org/pub/scm/linux/kernel/git/will/kvmtool.git/snapshot/$(kvmtool_tar)
kvmtool_hash := 3b4262ab5a1604152f74c43a7ef3aa89ee5216cf650c805e48140e9c31fdb5f0

kvmtool_target := \
	$(CROSS_TOOLS) \
	ARCH_HAS_FRAMEBUFFER=n \
	V=1
	#CPPFLAGS="-I$(INSTALL)/include" \
	#LDFLAGS="-L$(INSTALL)/lib" \

kvmtool_output := \
	lkvm \

kvmtool_libraries := \

kvmtool_configure := 
